{% extends "base_template.html"%}
{% load i18n %}
{%block content %}
<h3>{% trans "Validate Receipt" %}</h3>
<form method="post" action="">
    {{ formset.management_form }}
   
<table cellpadding="0" cellspacing="0" border="0" class="display" id="example">
    <thead>
        <tr>
        <th>{% trans "LTI" %}</th>
        <th>{% trans "Waybill Number" %}</th>
        <th>{% trans "Origin Warehouse" %}</th>
        <th>{% trans "Consignee" %}</th>
        <th>{% trans "Delivery Location" %}</th>
        <th>{% trans "Dispatched" %}</th>
        <th>{% trans "Received" %}</th>
        <th>{% trans "Validated" %}</th>
        <th></th>
        </tr>
        </thead>
    {% for form in formset.forms %}
    

    <tr>
             <td>{{ form.pk }}</td>
             <td>{{ form.instance.waybillNumber }}</td>
             <td>{{form.instance.origin_wh_name}}</td>
             <td>{{form.instance.consegnee_name}}</td>
             <td>{{form.instance.destination_loc_name}}</td>
             <td>{%if form.instance.dispatcherSigned%}{{form.instance.transportDispachSignedTimestamp|date:"Y/m/d"}}{%else%}{% trans "Pending"  %}{%endif%}</td>
              <td>{%if form.instance.recipientSigned%}{{form.instance.recipientSignedTimestamp|date:"Y/m/d"}}{%else%}{% trans "Pending" %}{%endif%}</td>
             <td>{{ form.waybillReceiptValidated }} {%if form.instance.hasError%}<span onMouseUp="alert('{{form.instance.errors.errorRec|escapejs}}')"><span style='color:red;'>{% trans "Error!" %}</span></span>{%endif%}</td>
             <td><a href='{{ form.instance.get_absolute_url }}'>{% trans "View" %}</a>{%if myprofile.super_user%} <a href='{% url waybill_validate_form_update waybill_pk=form.instance.pk %}'>{% trans "Edit" %}</a>{%endif%}</td>
    </tr>

    {% endfor %}
</table>

<input type="submit" value="{% trans 'Validate Waybills' %}"> {% csrf_token %}
</form>
<h3>{% trans "Update To Compas" %}</h3>
<br>
<table cellpadding="0" cellspacing="0" border="0" class="display" id="example2">
    <thead>
        <tr>
        <th>{% trans "LTI" %}</th>
        <th>{% trans "Waybill Number" %}</th>
        <th>{% trans "Origin Warehouse" %}</th>
        <th>{% trans "Consignee" %}</th>
        <th>{% trans "Delivery Location" %}</th>
        <th>{% trans "Dispatched" %}</th>
        <th>{% trans "Received" %}</th>
        <th>{% trans "Validated" %}</th>
        </tr>
        </thead>

    {% for wb in validatedWB %}
    <tr>
             <td>{{wb.ltiNumber}}</td>
             <td>{{wb.waybillNumber}}</td>
             <td>{{wb.origin_wh_name}}</td>
             <td>{{wb.consegnee_name}}</td>
             <td>{{wb.destination_loc_name}}</td>
             <td>{%if wb.dispatcherSigned%}{{wb.transportDispachSignedTimestamp|date:"Y/m/d"}}{%else%}{% trans "Pending" %}{%endif%}</td>
              <td>{%if wb.recipientSigned%}{{wb.recipientSignedTimestamp|date:"Y/m/d"}}{%else%}{% trans "Pending" %}{%endif%}</td>
             <td><form method="post" action='commit_to_compas_receipt_one/{{wb.id}}'> <input type="submit" value="{% trans 'Update In Compas' %}"> <input type="hidden" name="wb_id" value="{{wb.id}}">{% csrf_token %}</form></td>
    </tr>

    {% endfor %}
</table>
<!--
<form method="post" action="commit_to_compas_receipt/">
<input type="submit" value="Update Compas"> {% csrf_token %}
</form>
-->

{%endblock%}

{%block script%}
<script charset="utf-8">
$(document).ready(function() {
                $('#example').dataTable( {
                    "bPaginate": false,
                    "bLengthChange": false,
                    "bFilter": false,
                    "bSort": false,
                    "bInfo": false,
                    "bAutoWidth": false 
                });
        $('#example2').dataTable( {
                    "bPaginate": false,
                    "bLengthChange": false,
                    "bFilter": false,
                    "bSort": false,
                    "bInfo": false,
                    "bAutoWidth": false 
                });
} );
</script>
{%endblock script%}