{% extends "base_template.html"%}
{% load i18n %}
{%load extra_tags%}
{%block title %}{% trans "Waybill Creation" %}{%endblock%}
{%block content %}
<style type="text/css">
.ul-inline ul, .ul-inline ul li{border-width: 1px; display: inline; padding: 0px;}
.ul-inline{margin: 2px; border-color: black; border-style: none; border-width: 1px;}
</style>
<form action="" method=POST id="delform">
{% for hidden in form.hidden_fields %}
{{ hidden }}
{% endfor %}
{%for item in form%}
    {% if item.errors %}
    <ol>
        {% for error in item.errors %}
            <li>{{item.label}} <strong>{{ error|escape }}</strong></li>
        {% endfor %}
    </ol>
    {% endif %}
{% endfor %}
<div class="form">
    <div>
        <span><strong>{% trans "LTI:" %}</strong> {{form.instance.ltiNumber}}</span>
    </div>
    <div>
        <strong>{% trans "Waybill Number:" %}</strong> {{form.instance.waybillNumber}}
    </div>
    <div>
<br>
{%if  form.instance.hasError  %}
<div style='background-color:red;border:2px red solid;'>{% trans "Compas Issue:" %}<br>
    {%if form.instance.dispError%}{% trans "Dispatch Error:" %} {{form.instance.dispError}} <br>{%endif%}
    {%if form.instance.recError%}{% trans "Receipt Error:" %} {{form.instance.recError}} {%endif%}
</div>
{%endif%}
    <span>
    <table>
        <tr>
            <td>{% trans "Dispatch Signed:" %}</td>
            <td>{{form.dispatcherSigned}}</td>
        </tr>
        <tr>
            <td>{% trans "Dispatch Validated:" %}</td>
            <td>{{form.waybillValidated}}</td>
        </tr>
        <tr>
            <td>{% trans "Dispatch In Compas:" %}</td>
            <td>{{form.waybillSentToCompas}}</td>
        </tr>
        <tr>
            <td>{% trans "Receipt Signed:" %}</td>
            <td>{{form.recipientSigned}}</td>
        </tr>
        <tr>
            <td>{% trans "Receipt Validated:" %}</td>
            <td>{{form.waybillReceiptValidated}}</td>
        </tr>
        <tr>
            <td>{% trans "Receipt In Compas:" %}</td>
            <td>{{form.waybillRecSentToCompas}}</td>
        </tr>
        
    </table>
    <br>
    </span>
        <span><strong>{% trans "Date of Loading:" %}</strong> {{form.dateOfLoading}}</span>
        <span><strong>{% trans "Date of Dispatch:" %} </strong>{{form.dateOfDispatch}}</span>
    </div>
<table>
        <tr>
            <th>{% trans "Transaction Type:" %}</th>
            <td> {{form.transactionType}}</td>
            <td>&nbsp;</td>
            <th>{% trans "Transport Type:" %}</th>
            <td> {{form.transportType}}</td>
        </tr>
    </table>
<strong>{% trans "Destination Location:" %}</strong>   {{form.instance.recipientLocation}}  <br>
<strong>{% trans "Destination Warehouse" %}<strong> {{form.destinationWarehouse}}
<br>
<br>
 {{ formset.management_form }}
 <table cellpadding="1" cellspacing="0" border="1" class="x" id="example">
    <thead>
        <tr><th>{% trans "Item" %}</th><th>{% trans "Dispatched" %}</th><th>{% trans "Good" %}</th><th>{% trans "Damaged" %}</th><th>{% trans "Lost" %}</th>
        </thead>
    {% for sform in formset.forms %}
        <tr>
            <td>{{ sform.id }}{{sform.order_item}}</td>
            <td align="right">{{ sform.numberUnitsLoaded }}</td>
            <td>{{ sform.numberUnitsGood }}</td>
            <td>{{ sform.numberUnitsDamaged }} {% trans "Reason:" %}{{ sform.unitsDamagedReason }}</td>
            <td>{{ sform.numberUnitsLost }} {% trans "Reason:" %}{{ sform.unitsLostReason }}</td>

        </tr>
    {% endfor %}
</table>
<div>
 <br>
<div>
<div><strong>{% trans "Dispatch Remarks:" %}</strong> {{form.dispatchRemarks}}
<div><strong>{% trans "Dispatcher Name:" %}</strong>{{form.thisDispName}} - {{form.instance.dispatcherTitle}}</div>
<br>
<div><table>
<tr><td><strong>{% trans "Transport Contractor:" %}</strong></td><td>{{lti_list.0.transport_name}}</td></tr>
<tr><td><strong>{% trans "Transport Subcontractor:" %}</strong></td><td>{{form.transportSubContractor}}</td></tr>
<tr><td><strong>{% trans "Driver's Name:" %}</strong></td><td>{{form.transportDriverName}}</td></tr>
<tr><td><strong>{% trans "Driver's Licens No:" %}</strong></td><td>{{form.transportDriverLicenceID}}</td></tr>
<tr><td><strong>{% trans "Vehicle Registration No:" %}</strong></td><td>{{form.transportVehicleRegistration}}</td></tr>
<tr><td><strong>{% trans "Trailer Registration No:" %}</strong></td><td>{{form.transportTrailerRegistration}}</td></tr>
</table>
</div>
<br>
<strong>{% trans "Container 1: Number:" %}</strong>{{form.containerOneNumber}}<strong>{% trans "Seal:" %}</strong>{{form.containerOneSealNumber}}<strong> {% trans "Remarks:" %}</strong>{{form.containerOneRemarksDispatch}}<br>
<strong>{% trans "Container 2: Number:" %}</strong>{{form.containerTwoNumber}}<strong>{% trans "Seal:" %}</strong>{{form.containerTwoSealNumber}}<strong> {% trans "Remarks:" %}</strong>{{form.containerTwoRemarksDispatch}}

</div>
<BR>    
<div>
<table cellpadding="0" cellspacing="0" border="0">
<tr><td><strong>{% trans "Recipient Location:" %}</td><td> {{form.instance.recipientLocation}}</td></tr>
<tr><td><strong>{% trans "Consignee:" %}</td><td>{{form.instance.recipientConsingee}}</td></tr>
<tr><td><strong>{% trans "Receivers Name:" %}</td><td>{{form.thisRecName}} - {{form.instance.recipientTitle}}</td></tr>
<tr><td><strong>{% trans "Arrival Date:" %}</td><td>{{form.recipientArrivalDate}}</td></tr>
<tr><td><strong>{% trans "Start Discharge:" %}</td><td>{{form.recipientStartDischargeDate}}</td></tr>
<tr><td><strong>{% trans "End Discharge:" %} </td><td>{{form.recipientEndDischargeDate}}</td></tr>
<tr><td><strong>{% trans "Distance:" %} </td><td>{{form.recipientDistance}}</td></tr>
</table>
</div>
<table>
<tr><td colspan="3"><strong>{% trans "Recipient Remarks:" %}</td><td colspan="3">{{form.recipientRemarks}}</td></tr>

<tr><td><strong>{% trans "Container 1:" %}</td><td></td><td><strong>{% trans "Seal:" %}</td><td>{{form.instance.containerOneSealNumber}}</td><td><strong> {% trans "Remarks:" %}</td><td>{{form.containerOneRemarksReciept}}</td></tr>
<tr><td><strong>{% trans "Container 2:" %}</td><td></td><td><strong>{% trans "Seal:" %} </td><td>{{form.instance.containerTwoSealNumber}}</td><td><strong> {% trans "Remarks:" %}</td><td>{{form.containerTwoRemarksReciept}}</td></tr>
<tr v-align=top><td ><strong>{% trans "Reason" %} <br>{% trans "for Changes:" %}</td><td colspan=5>{{form.auditComment}}</td></tr>
</table>

<table>
    <tr>
        <td><input type="submit" value="{% trans 'Save & Exit' %}"> {% csrf_token %}
</form></td><td>&nbsp;</td>
        <td><SCRIPT LANGUAGE="JavaScript">
      function confirmAction() {
        return confirm("{% trans 'Are you sure that you want to remove waybill' %} {{form.instance.waybillNumber}}")
      }
</SCRIPT>
<form action="{% url invalidate_waybill waybill_pk=form.instance.pk %}"  onSubmit="return confirmAction()">
<input type="submit" value="{% trans 'INVALIDATE' %} "> 
</form></td>
    </tr>
</table>
<ul>
{%for line in audit%}
<li>{{line.action_date}} - {{line.action_user}} - {{line.auditComment}}
{%endfor%}
</ul>

</div>


{%endblock%}
{%block script%}
<script charset="utf-8" type="text/javascript">


$(document).ready(function() {

                $('#id_recipientArrivalDate').datepicker({ dateFormat: 'yy-mm-dd' });
                $('#id_recipientStartDischargeDate').datepicker({ dateFormat: 'yy-mm-dd' });
                $('#id_recipientEndDischargeDate').datepicker({ dateFormat: 'yy-mm-dd' });
                $('#id_dateOfDispatch').datepicker({ dateFormat: 'yy-mm-dd' });
                $('#id_dateOfLoading').datepicker({ dateFormat: 'yy-mm-dd' });                
                $('#example').dataTable( {
                    "bPaginate": false,
                    "bLengthChange": false,
                    "bFilter": false,
                    "bSort": false,
                    "bInfo": false,
                    "bAutoWidth": true 
                });
} );

</script>
{%endblock script%}
