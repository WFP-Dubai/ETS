{% extends "base_template.html" %}
{% load i18n extra_tags %}

{% block title %}{{ object }}{% endblock %}

{% block style %}
{{ block.super }}
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}css/waybill.css" media="screen"/>
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}css/print.css" media="print" />
{% endblock %}

{% block content %}
<div class="hidden_print actions">
  <a class="print_copy" href="#">Print Copy</a>
  {% waybill_edit object user %}

  {% sign_dispatch object user as may_sign_dispatch %}
  {% if may_sign_dispatch %}
  <a class="print_original" href="{% url waybill_finalize_dispatch waybill_pk=object.pk %}">Sign dispatch</a>
  {% endif %}
  
  {% sign_reception object user as may_sign_reception %}
  {% if may_sign_reception %}
  <a class="print_original" href="{% url waybill_finalize_receipt waybill_pk=object.pk %}">Sign reception</a>
  {% endif %}
  
  {% validate_dispatch object user %}
  {% validate_receipt object user %}
  
  {% waybill_reception object user %}
  {% waybill_delete object user %}
  
  <a href="{% url waybill_history waybill_pk=object.pk %}">{% trans "History" %}</a>
</div>
<table cellpadding="0" cellspacing="0" border="0px" >
  {% include 'waybill/print/wb_header.html'%}
  {% include 'waybill/print/wb_loading.html'%}
  {% include 'waybill/print/wb_receipt.html' with object=object.receipt %}
</table>
{% endblock %}

{% block script %}
{{ block.super }}
<script charset="utf-8">
  $(document).ready(function() {
    $('a.print_copy').click(function(){
    	$("#original_lable").addClass('hidden').removeClass('shown');
    	$("#copy_lable").addClass('shown').removeClass('hidden');
    	print();
    	return false;
    });
    
    $('a.print_original').click(function() {
      $("#original_lable").addClass('shown').removeClass('hidden');
      $("#copy_lable").addClass('hidden').removeClass('shown');
      print();
      $("#original_lable").addClass('hidden').removeClass('shown');
      $("#copy_lable").addClass('shown').removeClass('hidden');
    });
    
  });
</script>
{% endblock %}